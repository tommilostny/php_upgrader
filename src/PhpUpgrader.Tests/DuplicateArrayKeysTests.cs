using PhpUpgrader.Rubicon.UpgradeExtensions;

namespace PhpUpgrader.Tests;

public class DuplicateArrayKeysTests : UnitTestWithOutputBase
{
    public DuplicateArrayKeysTests(ITestOutputHelper output) : base(output)
    {
    }

    [Theory]
    [InlineData("<?php /*stuff before*/\n\n$cz_osetreni = array(\"(\" => \"\", \")\" => \"\", \"-\" => \"\", \"ě\" => \"e\", \"š\" => \"s\", \"č\" => \"c\", \"ř\"=>\"r\",\"ž\"=>\"z\",\"ý\"=>\"y\",\"á\"=>\"a\",\"í\"=>\"i\",\"é\"=>\"e\",\"ú\"=>\"u\",\"ů\"=>\"u\",\"Ě\" => \"e\", \"Š\" => \"s\", \"Č\" => \"c\", \"Ř\"=>\"r\",\"Ž\"=>\"z\",\"Ý\"=>\"y\",\"Á\"=>\"a\",\"Í\"=>\"i\",\"É\"=>\"e\",\"Ú\"=>\"u\",\"Ů\"=>\"u\",\"ą\" => \"a\",\"ć\" => \"c\",\"ę\" => \"e\",\"ł\" => \"l\",\"ń\" => \"n\",\"ó\" => \"o\",\"ś\" => \"s\",\"ź\" => \"z\",\"ż\" => \"z\",\"Ą\" => \"a\",\"Ć\" => \"c\",\"Ę\" => \"e\",\"Ł\" => \"l\",\"Ń\" => \"n\",\"Ó\" => \"o\",\"Ś\" => \"s\",\"Ź\" => \"z\",\"Ż\" => \"z\",\"á\" => \"a\",\"ä\" => \"a\",\"č\" => \"c\",\"ď\" => \"d\",\"dž\" => \"dz\",\"é\" => \"e\",\"í\" => \"i\",\"ľ\" => \"l\",\" ĺ \" => \"l\",\"ň\" => \"n\",\"ó\" => \"o\",\"ô\" => \"o\",\"ŕ\" => \"r\",\"š\" => \"s\",\"ť\" => \"t\",\"ú\" => \"u\",\"ý\" => \"y\",\"ž \" => \"z\",\"Á\" => \"a\",\"Ä\" => \"a\",\"Č\" => \"c\",\"Ď\" => \"d\",\"DŽ\" => \"dz\",\"É\" => \"e\",\"Í\" => \"i\",\"Ľ\" => \"l\",\" Ĺ \" => \"l\",\"Ň\" => \"n\",\"Ó\" => \"o\",\"Ô\" => \"o\",\"Ŕ\" => \"r\",\"Š\" => \"s\",\"Ť\" => \"t\",\"Ú\" => \"u\",\"Ý\" => \"y\",\"Ž \" => \"z\",\"*\" => \"\",\"!\" => \"\",\"\\\"\" => \"\",\"'\" => \"\",\"\\'\" => \"\",\"+\" => \"\",\",\" => \"_\",\" \" => \"_\",\"%\" => \"\");\n\n /*stuff after*/ ?>",
                "<?php /*stuff before*/\n\n$cz_osetreni = array(\"(\" => \"\", \")\" => \"\", \"-\" => \"\", \"ě\" => \"e\", \"ř\"=>\"r\", \"ž\"=>\"z\", \"ů\"=>\"u\", \"Ě\" => \"e\", \"Ř\"=>\"r\", \"Ž\"=>\"z\", \"Ů\"=>\"u\", \"ą\" => \"a\", \"ć\" => \"c\", \"ę\" => \"e\", \"ł\" => \"l\", \"ń\" => \"n\", \"ś\" => \"s\", \"ź\" => \"z\", \"ż\" => \"z\", \"Ą\" => \"a\", \"Ć\" => \"c\", \"Ę\" => \"e\", \"Ł\" => \"l\", \"Ń\" => \"n\", \"Ś\" => \"s\", \"Ź\" => \"z\", \"Ż\" => \"z\", \"á\" => \"a\", \"ä\" => \"a\", \"č\" => \"c\", \"ď\" => \"d\", \"dž\" => \"dz\", \"é\" => \"e\", \"í\" => \"i\", \"ľ\" => \"l\", \" ĺ \" => \"l\", \"ň\" => \"n\", \"ó\" => \"o\", \"ô\" => \"o\", \"ŕ\" => \"r\", \"š\" => \"s\", \"ť\" => \"t\", \"ú\" => \"u\", \"ý\" => \"y\", \"ž \" => \"z\", \"Á\" => \"a\", \"Ä\" => \"a\", \"Č\" => \"c\", \"Ď\" => \"d\", \"DŽ\" => \"dz\", \"É\" => \"e\", \"Í\" => \"i\", \"Ľ\" => \"l\", \" Ĺ \" => \"l\", \"Ň\" => \"n\", \"Ó\" => \"o\", \"Ô\" => \"o\", \"Ŕ\" => \"r\", \"Š\" => \"s\", \"Ť\" => \"t\", \"Ú\" => \"u\", \"Ý\" => \"y\", \"Ž \" => \"z\", \"*\" => \"\", \"!\" => \"\", \"\\\"\" => \"\", \"'\" => \"\", \"\\'\" => \"\", \"+\" => \"\", \",\" => \"_\", \" \" => \"_\", \"%\" => \"\");\n\n /*stuff after*/ ?>")]
    [InlineData("<?php /*stuff before*/\n\n$osetreni_url = array(\"ě\" => \"e\", \"š\" => \"s\", \"č\" => \"c\", \"ř\"=>\"r\",\"ž\"=>\"z\",\"ý\"=>\"y\",\"á\"=>\"a\",\"í\"=>\"i\",\"é\"=>\"e\",\"ú\"=>\"u\",\"ů\"=>\"u\",\"Ě\" => \"e\", \"Š\" => \"s\", \"Č\" => \"c\", \"Ř\"=>\"r\",\"Ž\"=>\"z\",\"Ý\"=>\"y\",\"Á\"=>\"a\",\"Í\"=>\"i\",\"É\"=>\"e\",\"Ú\"=>\"u\",\"Ů\"=>\"u\",\"ą\" => \"a\",\"ć\" => \"c\",\"ę\" => \"e\",\"ł\" => \"l\",\"ń\" => \"n\",\"ó\" => \"o\",\"ś\" => \"s\",\"ź\" => \"z\",\"ż\" => \"z\",\"Ą\" => \"a\",\"Ć\" => \"c\",\"Ę\" => \"e\",\"Ł\" => \"l\",\"Ń\" => \"n\",\"Ó\" => \"o\",\"Ś\" => \"s\",\"Ź\" => \"z\",\"Ż\" => \"z\",\"á\" => \"a\",\"ä\" => \"a\",\"č\" => \"c\",\"ď\" => \"d\",\"dž\" => \"dz\",\"é\" => \"e\",\"í\" => \"i\",\"ľ\" => \"l\",\" ĺ \" => \"l\",\"ň\" => \"n\",\"ó\" => \"o\",\"ô\" => \"o\",\"ŕ\" => \"r\",\"š\" => \"s\",\"ť\" => \"t\",\"ú\" => \"u\",\"ý\" => \"y\",\"ž \" => \"z\",\"Á\" => \"a\",\"Ä\" => \"a\",\"Č\" => \"c\",\"Ď\" => \"d\",\"DŽ\" => \"dz\",\"É\" => \"e\",\"Í\" => \"i\",\"Ľ\" => \"l\",\" Ĺ \" => \"l\",\"Ň\" => \"n\",\"Ó\" => \"o\",\"Ô\" => \"o\",\"Ŕ\" => \"r\",\"Š\" => \"s\",\"Ť\" => \"t\",\"Ú\" => \"u\",\"Ý\" => \"y\",\"Ž\" => \"z\",\"ň\" => \"n\");\n\n /*stuff after*/ ?>",
                "<?php /*stuff before*/\n\n$osetreni_url = array(\"ě\" => \"e\", \"ř\"=>\"r\", \"ž\"=>\"z\", \"ů\"=>\"u\", \"Ě\" => \"e\", \"Ř\"=>\"r\", \"Ů\"=>\"u\", \"ą\" => \"a\", \"ć\" => \"c\", \"ę\" => \"e\", \"ł\" => \"l\", \"ń\" => \"n\", \"ś\" => \"s\", \"ź\" => \"z\", \"ż\" => \"z\", \"Ą\" => \"a\", \"Ć\" => \"c\", \"Ę\" => \"e\", \"Ł\" => \"l\", \"Ń\" => \"n\", \"Ś\" => \"s\", \"Ź\" => \"z\", \"Ż\" => \"z\", \"á\" => \"a\", \"ä\" => \"a\", \"č\" => \"c\", \"ď\" => \"d\", \"dž\" => \"dz\", \"é\" => \"e\", \"í\" => \"i\", \"ľ\" => \"l\", \" ĺ \" => \"l\", \"ó\" => \"o\", \"ô\" => \"o\", \"ŕ\" => \"r\", \"š\" => \"s\", \"ť\" => \"t\", \"ú\" => \"u\", \"ý\" => \"y\", \"ž \" => \"z\", \"Á\" => \"a\", \"Ä\" => \"a\", \"Č\" => \"c\", \"Ď\" => \"d\", \"DŽ\" => \"dz\", \"É\" => \"e\", \"Í\" => \"i\", \"Ľ\" => \"l\", \" Ĺ \" => \"l\", \"Ň\" => \"n\", \"Ó\" => \"o\", \"Ô\" => \"o\", \"Ŕ\" => \"r\", \"Š\" => \"s\", \"Ť\" => \"t\", \"Ú\" => \"u\", \"Ý\" => \"y\", \"Ž\" => \"z\", \"ň\" => \"n\");\n\n /*stuff after*/ ?>")]
    [InlineData("<?php /*stuff before*/\n\n$cz_osetreni = array(\"(\" => \"\", \")\" => \"\", \"-\" => \"\", \"ě\" => \"e\", \"š\" => \"s\", \"č\" => \"c\", \"ř\"=>\"r\",\"ž\"=>\"z\",\"ý\"=>\"y\",\"á\"=>\"a\",\"í\"=>\"i\",\"é\"=>\"e\",\"ú\"=>\"u\",\"ů\"=>\"u\",\"Ě\" => \"e\", \"Š\" => \"s\", \"Č\" => \"c\", \"Ř\"=>\"r\",\"Ž\"=>\"z\",\"Ý\"=>\"y\",\"Á\"=>\"a\",\"Í\"=>\"i\",\"É\"=>\"e\",\"Ú\"=>\"u\",\"Ů\"=>\"u\",\"ą\" => \"a\",\"ć\" => \"c\",\"ę\" => \"e\",\"ł\" => \"l\",\"ń\" => \"n\",\"ó\" => \"o\",\"ś\" => \"s\",\"ź\" => \"z\",\"ż\" => \"z\",\"Ą\" => \"a\",\"Ć\" => \"c\",\"Ę\" => \"e\",\"Ł\" => \"l\",\"Ń\" => \"n\",\"Ó\" => \"o\",\"Ś\" => \"s\",\"Ź\" => \"z\",\"Ż\" => \"z\",\"á\" => \"a\",\"ä\" => \"a\",\"č\" => \"c\",\"ď\" => \"d\",\"dž\" => \"dz\",\"é\" => \"e\",\"í\" => \"i\",\"ľ\" => \"l\",\" ĺ \" => \"l\",\"ň\" => \"n\",\"ó\" => \"o\",\"ô\" => \"o\",\"ŕ\" => \"r\",\"š\" => \"s\",\"ť\" => \"t\",\"ú\" => \"u\",\"ý\" => \"y\",\"ž \" => \"z\",\"Á\" => \"a\",\"Ä\" => \"a\",\"Č\" => \"c\",\"Ď\" => \"d\",\"DŽ\" => \"dz\",\"É\" => \"e\",\"Í\" => \"i\",\"Ľ\" => \"l\",\" Ĺ \" => \"l\",\"Ň\" => \"n\",\"Ó\" => \"o\",\"Ô\" => \"o\",\"Ŕ\" => \"r\",\"Š\" => \"s\",\"Ť\" => \"t\",\"Ú\" => \"u\",\"Ý\" => \"y\",\"Ž \" => \"z\",\"*\" => \"\",\"!\" => \"\",\"\u001f®\" => \"&reg;\",\"©\" => \"&copy;\");\n\n /*stuff after*/ ?>",
                "<?php /*stuff before*/\n\n$cz_osetreni = array(\"(\" => \"\", \")\" => \"\", \"-\" => \"\", \"ě\" => \"e\", \"ř\"=>\"r\", \"ž\"=>\"z\", \"ů\"=>\"u\", \"Ě\" => \"e\", \"Ř\"=>\"r\", \"Ž\"=>\"z\", \"Ů\"=>\"u\", \"ą\" => \"a\", \"ć\" => \"c\", \"ę\" => \"e\", \"ł\" => \"l\", \"ń\" => \"n\", \"ś\" => \"s\", \"ź\" => \"z\", \"ż\" => \"z\", \"Ą\" => \"a\", \"Ć\" => \"c\", \"Ę\" => \"e\", \"Ł\" => \"l\", \"Ń\" => \"n\", \"Ś\" => \"s\", \"Ź\" => \"z\", \"Ż\" => \"z\", \"á\" => \"a\", \"ä\" => \"a\", \"č\" => \"c\", \"ď\" => \"d\", \"dž\" => \"dz\", \"é\" => \"e\", \"í\" => \"i\", \"ľ\" => \"l\", \" ĺ \" => \"l\", \"ň\" => \"n\", \"ó\" => \"o\", \"ô\" => \"o\", \"ŕ\" => \"r\", \"š\" => \"s\", \"ť\" => \"t\", \"ú\" => \"u\", \"ý\" => \"y\", \"ž \" => \"z\", \"Á\" => \"a\", \"Ä\" => \"a\", \"Č\" => \"c\", \"Ď\" => \"d\", \"DŽ\" => \"dz\", \"É\" => \"e\", \"Í\" => \"i\", \"Ľ\" => \"l\", \" Ĺ \" => \"l\", \"Ň\" => \"n\", \"Ó\" => \"o\", \"Ô\" => \"o\", \"Ŕ\" => \"r\", \"Š\" => \"s\", \"Ť\" => \"t\", \"Ú\" => \"u\", \"Ý\" => \"y\", \"Ž \" => \"z\", \"*\" => \"\", \"!\" => \"\", \"\u001f®\" => \"&reg;\", \"©\" => \"&copy;\");\n\n /*stuff after*/ ?>")]
    public void RemovesDuplicateKeysFromArray(string input, string expectedOutput)
    {
        //Arrange
        var file = new FileWrapper("somefile.php", input);

        //Act
        file.UpgradeDuplicateArrayKeys();

        //Assert
        _output.WriteLine(input);
        var updated = file.Content.ToString();
        _output.WriteLine(updated);
        Assert.True(file.IsModified);
        Assert.Equal(expectedOutput, updated);
    }
}
